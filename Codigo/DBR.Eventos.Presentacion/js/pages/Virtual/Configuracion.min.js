var contenidoHtml="",editor,Eventos={ListAllEventoCombo:function(){$.ajax({url:urlListAllEventoCombo,type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",async:!1,success:function(n){DBR.LlenarCombo(n,"#cboEvento",!0,!1)},error:function(n,t){console.log(t)}})},GetContenidoVirtualByEvento:function(){var n={};n.IdEvento=$("#cboEvento").val();DBR.blockUIStar();$.ajax({url:urlGetContenidoVirtualByEvento,type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify({request:n}),success:function(n){DBR.blockUIStop();$("#txtViertualContenido").val(n.IdVirtualContenido);n.Contenido=n.Contenido.replace(/div/g,"p");CKEDITOR.instances.txtMensajeCompleto.setData(n.Contenido);contenidoHtml=n.Contenido},error:function(n,t){DBR.blockUIStop();$("#txtViertualContenido").val(0);CKEDITOR.instances.txtMensajeCompleto.setData("<p><\/p>");contenidoHtml="<p><\/p>";console.log(t)}})},SaveVirtualContenido:function(){var n={};n.IdVirtualContenido=$("#txtViertualContenido").val();n.IdEvento=$("#cboEvento").val();n.Contenido=contenidoHtml;DBR.blockUIStar();$.ajax({url:urlSaveVirtualContenido,type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify({request:n}),success:function(n){DBR.blockUIStop();n.IsSuccess?($("#txtViertualContenido").val(n.Codigo),editor.setReadOnly(!0),$("#btnGuardarContenido").hide(),$("#btnEditarContenido").show(),DBR.ToastSuccess(n.Message)):DBR.ToastError(n.Message)},error:function(n,t){console.log(t)}})},ListVirtualVideoByEvento:function(){var n={};n.IdEvento=$("#cboEvento").val();$.ajax({url:urlListVirtualVideoByEvento,type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify({request:n}),success:function(n){Funciones.LlenarVirtualVideo(n)},error:function(n,t){console.log(t)}})},SaveVirtualVideo:function(){var n={};n.IdVirtualVideo=$("#txtIdVirtualVideo").val();n.IdEvento=$("#cboEvento").val();n.Url=$("#txtUrl").val();DBR.blockUIStar();$.ajax({url:urlSaveVirtualVideo,type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify({request:n}),success:function(n){DBR.blockUIStop();n.IsSuccess?($("#modalVirtualVideo").modal("hide"),Eventos.ListVirtualVideoByEvento(),DBR.ToastSuccess(n.Message)):DBR.ToastError(n.Message)},error:function(n,t){console.log(t)}})},GetVirtualVideo:function(n){$("#txtIdVirtualVideo").val(n);DBR.limpiarCampo("#txtUrl");$("#lblTitleAgregarVirtualVideo").html("Editar");var t={};t.IdVirtualVideo=$("#txtIdVirtualVideo").val();DBR.blockUIStar();$.ajax({url:urlGetVirtualVideo,type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify({request:t}),success:function(n){DBR.blockUIStop();$("#txtUrl").val(n.Url);$("#modalVirtualVideo").modal("show")},error:function(n,t){console.log(t)}})},DeleteVirtualVideo:function(n){var t={};t.IdVirtualVideo=n;BootstrapDialog.show({title:"Confirmación",closeByBackdrop:!1,message:"¿Esta seguro de eliminar el registro?",size:BootstrapDialog.SIZE_SMALL,buttons:[{label:"Si",cssClass:"btn-primary btn-sm",action:function(n){DBR.blockUIStar();$.ajax({url:urlDeleteVirtualVideo,type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify({request:t}),success:function(t){DBR.blockUIStop();n.close();t.IsSuccess?(Eventos.ListVirtualVideoByEvento(),DBR.ToastSuccess(t.Message)):DBR.ToastError(t.Message)},error:function(n,t){DBR.blockUIStop();console.log(t)}})}},{label:"No",cssClass:"btn-default btn-sm",action:function(n){n.close()}}]})}},Funciones={LlenarVirtualVideo:function(n){var t="",i=$("#cabeceraGrilla").width();$.each(n,function(n,i){var r='<a data-toggle="tooltip1" data-placement="bottom" title="Editar" onclick="Eventos.GetVirtualVideo('+i.IdVirtualVideo+')" class="btn btn-primary btn-xs"><span class="glyphicon glyphicon-pencil" aria-hidden="true"><\/span><\/a>',u='<a data-toggle="tooltip1" data-placement="bottom" title="Eliminar" onclick="Eventos.DeleteVirtualVideo('+i.IdVirtualVideo+')" class="btn btn-primary btn-xs"><span class="glyphicon glyphicon-trash" aria-hidden="true"><\/span><\/a>';t=t+'<tr><td><div class="UrlVideos">'+i.Url+'<\/div><\/td><td class="text-center">'+r+" "+u+"<\/td><\/tr>"});t==""&&(t=t+'<tr><td colspan="2">No se encontraron registros<\/td><\/tr>');$("#bodyVirtualVideo").html(t);$(".UrlVideos").width(i);$('[data-toggle="tooltip1"]').tooltip()}};$(document).ready(function(){Eventos.ListAllEventoCombo();Eventos.GetContenidoVirtualByEvento();Eventos.ListVirtualVideoByEvento();var n=CKEDITOR.replace("txtMensajeCompleto",{height:500});n.on("change",function(n){contenidoHtml=n.editor.getData()});n.on("instanceReady",function(n){editor=n.editor;editor.setReadOnly(!0)});$("#btnEditarContenido").on("click",function(){editor.setReadOnly(!1);$(this).hide();$("#btnGuardarContenido").show()});$("#btnGuardarContenido").on("click",function(){Eventos.SaveVirtualContenido()});$("#cboEvento").on("change",function(){editor.setReadOnly(!0);$("#btnGuardarContenido").hide();$("#btnEditarContenido").show();Eventos.GetContenidoVirtualByEvento();Eventos.ListVirtualVideoByEvento()});$("#btnAgregarVideo").on("click",function(){$("#txtIdVirtualVideo").val(0);DBR.limpiarCampo("#txtUrl");$("#lblTitleAgregarVirtualVideo").html("Agregar");$("#modalVirtualVideo").modal("show")});$("#btnGuardarVirtualVideo").on("click",function(){DBR.validarCampo("#txtUrl")&&Eventos.SaveVirtualVideo()})});