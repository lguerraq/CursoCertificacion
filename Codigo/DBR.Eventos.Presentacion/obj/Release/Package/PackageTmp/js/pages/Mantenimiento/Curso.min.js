var EditarDocumento1=!1,EditarDocumento2=!1,EditarDocumento3=!1,EditarDocumento4=!1,EditarDocumento5=!1,config={ini:function(){$.ajaxSetup({type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:{}})},iniGrids:{GrillaEventos:function(){$("#gridEventos").DataTable({searching:!0,ordering:!1,processing:!0,serverSide:!0,destroy:!0,responsive:!0,stateSave:!0,language:{url:"//cdn.datatables.net/plug-ins/1.10.15/i18n/Spanish.json"},ajax:{url:urlListEvento,type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",datatype:"json",data:function(n){return JSON.stringify({page1:n})}},columns:[{data:function(n){return'<div title="'+n.NombreEvento+'" style="max-width:400px; overflow:hidden;white-space:nowrap;text-overflow: ellipsis;">'+n.NombreEvento+"<\/div>"},bSortable:!1,sClass:"text-left"},{data:function(n){return parseJsonDate(n.Fecha)},bSortable:!1,sClass:"text-center"},{data:function(n){return n.Activo?"SI":"NO"},sClass:"text-center"},{data:"Costo",sClass:"text-center"},{data:function(n){return n.DetallarCertificado?"2 Páginas":"1 Página"},sClass:"text-center"},{data:function(n){return n.GenerarCertificado?"Habilitado":"Deshabilitado"},sClass:"text-center"},{data:function(n){let t='<a class="btn btn-default btn-xs" data-toggle="tooltip1" data-placement="bottom" title="Descargar foto" href="'+urlDescargaDocumentos+n.ImagenEvento+'" target="_blank"><i class="fa fa-file-image-o"><\/i><\/a>',i='<a class="btn btn-default btn-xs" data-toggle="tooltip1" data-placement="bottom" title="Descargar pdf participante" href="'+urlDescargaDocumentos+n.DocumentoCertificadoImprimir+'" target="_blank"><i class="fa fa-file"><\/i><\/a>',r='<a class="btn btn-default btn-xs" data-toggle="tooltip1" data-placement="bottom" title="Descargar pdf expositor" href="'+urlDescargaDocumentos+n.DocumentoCertificadoExpositor+'" target="_blank"><i class="fa fa-file-pdf-o"><\/i><\/a>';return t+" "+i+" "+r},sClass:"text-center"},{data:function(n,t,i,r){var e='<a data-toggle="tooltip1" data-placement="bottom" title="Editar" onclick="Eventos.GetEvento('+n.IdEvento+","+(r.row+1)+')" class="btn btn-primary btn-xs"><span class="glyphicon glyphicon-pencil" aria-hidden="true"><\/span><\/a>',o='<a data-toggle="tooltip1" data-placement="bottom" title="Eliminar" onclick="Eventos.DeleteEvento('+n.IdEvento+')" class="btn btn-primary btn-xs"><span class="glyphicon glyphicon-trash" aria-hidden="true"><\/span><\/a>',u='<a data-toggle="tooltip1" data-placement="bottom" title="Activar" onclick="Eventos.UpdateEstadoEvento('+n.IdEvento+',1)" class="btn btn-primary btn-xs"><span class="glyphicon glyphicon-ok" aria-hidden="true"><\/span><\/a>',s='<a data-toggle="tooltip1" data-placement="bottom" title="Código" onclick="Eventos.VerCodigoRegistro(\''+n.rowid+'\')" class="btn btn-primary btn-xs"><span class="fa  fa-code" aria-hidden="true"><\/span><\/a>',f='<a data-toggle="tooltip1" data-placement="bottom" title="Desactivar" onclick="Eventos.UpdateEstadoEvento('+n.IdEvento+',0)" class="btn btn-primary btn-xs"><span class="glyphicon glyphicon-remove" aria-hidden="true"><\/span><\/a>',h='<a data-toggle="tooltip1" data-placement="bottom" title="Módulos" onclick="Eventos.Modulos('+n.IdEvento+", '"+n.NombreEvento+'\')" class="btn btn-primary btn-xs"><span class="fa fa-file-text" aria-hidden="true"><\/span><\/a>';return n.Activo?u="":f="",e+" "+o+" "+s+" "+u+" "+f+" "+h},sClass:"text-center"}],drawCallback:function(){$('[data-toggle="tooltip1"]').tooltip({container:"body"})}})},GrillaModulo:function(){$("#gridModulos").DataTable({searching:!0,ordering:!1,processing:!0,serverSide:!0,destroy:!0,responsive:!0,autoWidth:!1,language:{url:"//cdn.datatables.net/plug-ins/1.10.15/i18n/Spanish.json"},ajax:{url:urlListModuloPaged,type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:function(n){var t={};return t.IdEvento=$("#txtIdEvento2").val(),JSON.stringify({page:n,request:t})}},columns:[{data:"Nombre",width:"40%"},{data:"Expositor",width:"40%"},{data:"Horas",sClass:"text-center",width:"10%"},{data:function(n){var t='<a data-toggle="tooltip1" data-placement="bottom" title="Editar" onclick="Eventos.GetModulo('+n.IdModulo+')" class="btn btn-primary btn-xs"><span class="glyphicon glyphicon-pencil" aria-hidden="true"><\/span><\/a>',i='<a data-toggle="tooltip1" data-placement="bottom" title="Eliminar" onclick="Eventos.DeleteModulo('+n.IdModulo+')" class="btn btn-primary btn-xs"><span class="glyphicon glyphicon-trash" aria-hidden="true"><\/span><\/a>';return t+" "+i},sClass:"text-center",width:"10%"}],drawCallback:function(){$('[data-toggle="tooltip1"]').tooltip()}})}}},Eventos={ValoresIniciales:function(){DBR.blockUIStar();$.ajax({url:urlValoresIniciales,type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){DBR.LlenarCombo(n.TipoCurso,"#ddlTipo",!1,!1,"Seleccione");DBR.LlenarCombo(n.TipoTema,"#cboTema",!0,!1,"Seleccione");DBR.LlenarCombo(n.TipoModalidad,"#cboModalidad",!1,!1,"Seleccione");DBR.blockUIStop()},error:function(n,t){console.log(t)}})},SaveEvento:function(){var t=document.getElementById("fileFoto"),i=document.getElementById("fileCertificadoImprimir"),r=document.getElementById("fileCertificadoExpositor"),n=new FormData;n.append("documento1",t.files[0]);n.append("documento4",i.files[0]);n.append("documento5",r.files[0]);n.append("IdEvento",$("#txtIdEvento").val());n.append("Tipo",$("#ddlTipo").val());n.append("Modalidad",$("#cboModalidad").val());n.append("NombreEvento",$("#txtNombreEvento").val());n.append("Descripcion",$("#txtDescripcion").val());n.append("Fecha",$("#txtFecha").val());n.append("Expositor",$("#txtExpositor").val());n.append("Horas",$("#txtHoras").val());n.append("CostoValor",$("#txtCostoValor").val());n.append("CostoValorPromocional",$("#txtCostoValorPromocional").val());n.append("Costo",$("#cboCosto").val());n.append("NotaAprobatoria",$("#txtNotaAprobatoria").val());n.append("ListaTemas",$("#cboTema").val());n.append("DetallarCertificado",$("#chckDetallarCertificado").prop("checked"));n.append("GenerarCertificado",$("#chckGenerarCertificado").prop("checked"));DBR.blockUIStar();$.ajax({url:urlSaveEvento,type:"POST",dataType:"json",cache:!1,contentType:!1,processData:!1,data:n}).done(function(n){DBR.blockUIStop();n.IsSuccess?($("#gridEventos").DataTable().ajax.reload(),$("#modalEvento").modal("hide"),DBR.ToastSuccess(n.Message)):DBR.ToastError(n.Message)}).fail(function(n){DBR.blockUIStop();console.log(n)})},GetEvento:function(n,t){$("#lblTitleAgregarEvento").html("Editar");Funciones.LimpiarCamposEvento();var i={};i.IdEvento=n;DBR.blockUIStar();$.ajax({url:urlGetEvento,type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify({request:i}),success:function(n){DBR.blockUIStop();$("#txtIdEvento").val(n.IdEvento);$("#ddlTipo").val(n.Tipo);$("#cboModalidad").val(IsNull(n.Modalidad,0));$("#txtNombreEvento").val(n.NombreEvento);$("#txtDescripcion").val(n.Descripcion);$("#txtFecha").val(parseJsonDate(n.Fecha));$("#txtExpositor").val(n.Expositor);$("#txtCostoValor").val(n.CostoValor);$("#txtCostoValorPromocional").val(n.CostoValorPromocional);$("#cboCosto").val(n.Costo);$("#txtNotaAprobatoria").val(n.NotaAprobatoria);$("#txtHoras").val(n.Horas);$($("#fileFoto").next().children()[0]).val("FOTO"+t+".PDF");$($("#fileFotocheck").next().children()[0]).val("FOTOCHECK"+t+".PDF");$($("#fileCertificado").next().children()[0]).val("CERTIFICADO"+t+".PDF");$($("#fileCertificadoImprimir").next().children()[0]).val("CERTIFICADO-IMPRESION"+t+".PDF");$($("#fileCertificadoExpositor").next().children()[0]).val("CERTIFICADO-EXPOSITOR"+t+".PDF");EditarDocumento1=!1;EditarDocumento2=!1;EditarDocumento3=!1;EditarDocumento4=!1;EditarDocumento5=!1;$("#cboTema").val(n.IdsTemas).trigger("change");n.DetallarCertificado?$("#chckDetallarCertificado").iCheck("check"):$("#chckDetallarCertificado").iCheck("uncheck");n.GenerarCertificado?$("#chckGenerarCertificado").iCheck("check"):$("#chckGenerarCertificado").iCheck("uncheck");$("#modalEvento").modal("show")},error:function(n,t){DBR.blockUIStop();console.log(t)}})},DeleteEvento:function(n){var t={};t.IdEvento=n;BootstrapDialog.show({title:"Confirmación",closeByBackdrop:!1,message:"¿Esta seguro de eliminar el registro?",size:BootstrapDialog.SIZE_SMALL,buttons:[{label:"Si",cssClass:"btn-primary btn-sm",action:function(n){DBR.blockUIStar();$.ajax({url:urlDeleteEvento,type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify({request:t}),success:function(t){DBR.blockUIStop();n.close();t.IsSuccess?($("#gridEventos").DataTable().ajax.reload(),DBR.ToastSuccess(t.Message)):DBR.ToastError(t.Message)},error:function(n,t){DBR.blockUIStop();console.log(t)}})}},{label:"No",cssClass:"btn-default btn-sm",action:function(n){n.close()}}]})},UpdateEstadoEvento:function(n,t){var i={};i.IdEvento=n;i.Activo=t;BootstrapDialog.show({title:"Confirmación",closeByBackdrop:!1,message:"¿Esta seguro de cambiar el estado del registro?",size:BootstrapDialog.SIZE_SMALL,buttons:[{label:"Si",cssClass:"btn-primary btn-sm",action:function(n){DBR.blockUIStar();$.ajax({url:urUpdateEstadoEvento,type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify({request:i}),success:function(t){DBR.blockUIStop();n.close();t.IsSuccess?($("#gridEventos").DataTable().ajax.reload(),DBR.ToastSuccess(t.Message)):DBR.ToastError(t.Message)},error:function(n,t){DBR.blockUIStop();console.log(t)}})}},{label:"No",cssClass:"btn-default btn-sm",action:function(n){n.close()}}]})},VerCodigoRegistro:function(n){$("#txtCodigoRegistro").val(n);$("#modalCodigo").modal("show")},Modulos:function(n){window.location.href=urlModulos+"?idCurso="+n},SaveModulo:function(){var n={};n.IdModulo=$("#txtIdModulo").val();n.IdEvento=$("#txtIdEvento2").val();n.Nombre=$("#txtModuloNombre").val();n.Descripcion=$("#txtModuloDescripcion").val();n.Expositor=$("#txtModuloExpositor").val();n.Horas=$("#txtModuloHoras").val();DBR.blockUIStar();$.ajax({url:urlSaveModulo,type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify({request:n}),success:function(n){DBR.blockUIStop();n.IsSuccess?($("#gridModulos").DataTable().ajax.reload(),$("#modalModulo").modal("hide"),DBR.ToastSuccess(n.Message)):DBR.ToastError(n.Message)},error:function(n,t){DBR.blockUIStop();console.log(t)}})},GetModulo:function(n){$("#lblTitleModal").html("Editar");Funciones.LimpiarCamposModulo();var t={};t.IdModulo=n;DBR.blockUIStar();$.ajax({url:urlGetModulo,type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify({request:t}),success:function(n){DBR.blockUIStop();$("#txtIdModulo").val(n.IdModulo);$("#txtModuloNombre").val(n.Nombre);$("#txtModuloDescripcion").val(n.Descripcion);$("#txtModuloExpositor").val(n.Expositor);$("#txtModuloHoras").val(n.Horas);$("#modalModulo").modal("show")},error:function(n,t){DBR.blockUIStop();console.log(t)}})},DeleteModulo:function(n){var t={};t.IdModulo=n;BootstrapDialog.show({title:"Confirmación",closeByBackdrop:!1,message:"¿Esta seguro de eliminar el registro?",size:BootstrapDialog.SIZE_SMALL,buttons:[{label:"Si",cssClass:"btn-primary btn-sm",action:function(n){DBR.blockUIStar();$.ajax({url:urlDeleteModulo,type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify({request:t}),success:function(t){DBR.blockUIStop();n.close();t.IsSuccess?($("#gridModulos").DataTable().ajax.reload(),DBR.ToastSuccess(t.Message)):DBR.ToastError(t.Message)},error:function(n,t){DBR.blockUIStop();console.log(t)}})}},{label:"No",cssClass:"btn-default btn-sm",action:function(n){n.close()}}]})}},Funciones={LimpiarCamposEvento:function(){$("#fileFoto").filestyle("clear");$("#fileFoto").parent().removeClass("has-error");$("#fileFoto").next().next().addClass("hide");$("#fileFotocheck").filestyle("clear");$("#fileFotocheck").parent().removeClass("has-error");$("#fileFotocheck").next().next().addClass("hide");$("#fileCertificado").filestyle("clear");$("#fileCertificado").parent().removeClass("has-error");$("#fileCertificado").next().next().addClass("hide");$("#fileCertificadoImprimir").filestyle("clear");$("#fileCertificadoImprimir").parent().removeClass("has-error");$("#fileCertificadoImprimir").next().next().addClass("hide");$("#fileCertificadoExpositor").filestyle("clear");$("#fileCertificadoExpositor").parent().removeClass("has-error");$("#fileCertificadoExpositor").next().next().addClass("hide");DBR.limpiarCampo("#ddlTipo");DBR.limpiarCampo("#cboModalidad");DBR.limpiarCampo("#txtDescripcion");DBR.limpiarCampo("#txtNombreEvento");DBR.limpiarCampo("#txtFecha");DBR.limpiarCampo("#txtExpositor");DBR.limpiarCampo("#txtHoras");DBR.limpiarCampo("#txtCostoValor");DBR.limpiarCampo("#cboCosto");DBR.limpiarCampo("#txtNotaAprobatoria");$("#txtCostoValorPromocional").val();DBR.limpiarCampo("#cboTema")},LimpiarCamposModulo:function(){DBR.limpiarCampo("#txtModuloNombre");DBR.limpiarCampo("#txtModuloDescripcion");DBR.limpiarCampo("#txtModuloExpositor");DBR.limpiarCampo("#txtModuloHoras")}};$(document).ready(function(){config.iniGrids.GrillaEventos();config.iniGrids.GrillaModulo();Eventos.ValoresIniciales();$("input").iCheck({checkboxClass:"icheckbox_square-blue",radioClass:"iradio_square-blue",increaseArea:"20%"});$("#txtFecha").datepicker({autoclose:!0,language:"es",format:"dd/mm/yyyy"});$("#txtHoras").numericInput({allowFloat:!1,allowNegative:!1});$("#txtModuloHoras").numericInput({allowFloat:!1,allowNegative:!1});$("#txtCostoValor").numericInput({allowFloat:!0,allowNegative:!1});$("#txtCostoValorPromocional").numericInput({allowFloat:!0,allowNegative:!1});$("#txtNotaAprobatoria").numericInput({allowFloat:!0,allowNegative:!1,max:20,min:0});$("#cboCosto").on("change",function(){$(this).val()=="NO"?($("#txtCostoValor").prop("disabled",!0),$("#txtCostoValor").val("0"),$("#txtCostoValorPromocional").prop("disabled",!0),$("#txtCostoValorPromocional").val("")):($("#txtCostoValor").prop("disabled",!1),$("#txtCostoValor").val(""),$("#txtCostoValorPromocional").prop("disabled",!1),$("#txtCostoValorPromocional").val(""))});var n=window.URL||window.webkitURL;$("#fileFoto").on("change",function(){var t,i,r,u;EditarDocumento1=!0;(i=this.files[0])&&(r=this.files[0].size,u=parseInt(r/1024),t=new Image,t.onload=function(){u>1024&&(DBR.ToastWarning("Verifique que la foto adjunta no supere el 1MB"),$("#fileFoto").filestyle("clear"));(this.width!==780||this.height!=450)&&(DBR.ToastWarning("Verifique que la foto compla con las dimenciones ancho: 780px y alto:450px"),$("#fileFoto").filestyle("clear"))},t.src=n.createObjectURL(i))});$("#fileFotocheck").on("change",function(){EditarDocumento2=!0});$("#fileCertificado").on("change",function(){EditarDocumento3=!0});$("#fileCertificadoImprimir").on("change",function(){EditarDocumento4=!0});$("#fileCertificadoExpositor").on("change",function(){EditarDocumento5=!0});$("#btnAgregarEvento").on("click",function(){EditarDocumento1=!0;EditarDocumento2=!0;EditarDocumento3=!0;EditarDocumento4=!0;EditarDocumento5=!0;$("#lblTitleAgregarEvento").html("Agregar");Funciones.LimpiarCamposEvento();$("#modalEvento").modal("show")});$("#btnGuardarEvento").on("click",function(){var n=!0,i,t;DBR.validarCampo("#txtNombreEvento")||(n=!1);DBR.validarCampo("#ddlTipo")||(n=!1);DBR.validarCampo("#cboModalidad")||(n=!1);DBR.validarCampo("#txtDescripcion")||(n=!1);DBR.validarCampo("#txtFecha")||(n=!1);DBR.validarCampo("#txtExpositor")||(n=!1);DBR.validarCampo("#cboCosto")||(n=!1);DBR.validarCampo("#txtCostoValor")||(n=!1);DBR.validarCampo("#txtNotaAprobatoria")||(n=!1);DBR.validarCampo("#txtHoras")||(n=!1);EditarDocumento1&&(i=document.getElementById("fileFoto"),i.files.length==0?($("#fileFoto").parent().addClass("has-error"),$("#fileFoto").next().next().removeClass("hide"),n=!1):($("#fileFoto").parent().removeClass("has-error"),$("#fileFoto").next().next().addClass("hide"),i.files[0].size>3145728&&(DBR.ToastWarning("Verifique que el archivo adjunto no supere el 1MB"),n=!1)));EditarDocumento4&&(t=document.getElementById("fileCertificadoImprimir"),t.files.length==0?($("#fileCertificadoImprimir").parent().addClass("has-error"),$("#fileCertificadoImprimir").next().next().removeClass("hide"),n=!1):($("#fileCertificadoImprimir").parent().removeClass("has-error"),$("#fileCertificadoImprimir").next().next().addClass("hide"),t.files[0].size>3145728&&(DBR.ToastWarning("Verifique que el archivo adjunto no supere el 3MB"),n=!1)));EditarDocumento5&&(t=document.getElementById("fileCertificadoExpositor"),t.files.length==0?($("#fileCertificadoExpositor").parent().addClass("has-error"),$("#fileCertificadoExpositor").next().next().removeClass("hide"),n=!1):($("#fileCertificadoExpositor").parent().removeClass("has-error"),$("#fileCertificadoExpositor").next().next().addClass("hide"),t.files[0].size>3145728&&(DBR.ToastWarning("Verifique que el archivo adjunto no supere el 3MB"),n=!1)));DBR.validarCampo("#cboTema")||(n=!1);n&&Eventos.SaveEvento()});$("#btnAgregarModulo").on("click",function(){$("#lblTitleModal").html("Agregar");$("#txtIdModulo").val(0);Funciones.LimpiarCamposModulo();$("#modalModulo").modal("show")});$("#btnGuardarModulo").on("click",function(){var n=!0;DBR.validarCampo("#txtModuloNombre")||(n=!1);DBR.validarCampo("#txtModuloDescripcion")||(n=!1);DBR.validarCampo("#txtModuloExpositor")||(n=!1);DBR.validarCampo("#txtModuloHoras")||(n=!1);n&&Eventos.SaveModulo()});$("#modalModulo").on("hidden.bs.modal",function(){$("body").addClass("modal-open")})});