var GrillaEmpresas,config={iniGrids:{GridEmpresas:function(){GrillaEmpresas=$("#gridEmpresas").DataTable({searching:!0,ordering:!1,processing:!0,serverSide:!0,destroy:!0,responsive:!0,stateSave:!0,language:{url:"//cdn.datatables.net/plug-ins/1.10.15/i18n/Spanish.json"},ajax:{url:urlListEmpresaPaginado,type:"POST",datatype:"json",contentType:"application/json; charset=UTF-8",data:function(n){return JSON.stringify({page:n})}},columns:[{data:"Ruc",sClass:"text-left"},{data:"RazonSocial",sClass:"text-left"},{data:"NombreComercial",sClass:"text-left"},{data:"Responsable",sClass:"text-left"},{data:function(n){var t='<a data-toggle="tooltip1" data-placement="bottom" title="Eliminar" onclick="Eventos.DeleteEmpresa('+n.IdEmpresa+')" class="btn btn-primary btn-xs"><span class="glyphicon glyphicon-trash" aria-hidden="true"><\/span><\/a>',i='<a data-toggle="tooltip1" data-placement="bottom" title="Editar" onclick="Eventos.GetEmpresa('+n.IdEmpresa+')" class="btn btn-primary btn-xs"><span class="glyphicon glyphicon-pencil" aria-hidden="true"><\/span><\/a>';return i+" "+t},sClass:"text-center"}],drawCallback:function(){$('[data-toggle="tooltip1"]').tooltip({container:"body"})}})}}},Eventos={SaveEmpresa:function(){DBR.blockUIStar();let n={IdEmpresa:$("#txtIdEmpresa").val(),Ruc:$("#txtRuc").val(),RazonSocial:$("#txtRazonSocial").val(),NombreComercial:$("#txtNombreComercial").val(),DireccionFiscal:$("#txtDireccionFiscal").val(),Frecuencia:$("#cboFrecuencia").val()},t={Login:$("#txtLogin").val(),NumeroDocumento:$("#txtNumeroDocumento").val(),Nombres:$("#txtNombres").val().toUpperCase(),ApellidoPaterno:$("#txtApellidoPaterno").val().toUpperCase(),ApellidoMaterno:$("#txtApellidoMaterno").val().toUpperCase(),Correo:$("#txtCorreo").val().toUpperCase(),IdUsuarioTipo:6};$.ajax({url:urlSaveEmpresa,type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify({request:n,requestuser:t}),success:function(n){n.IsSuccess?(DBR.ToastSuccess(n.Message),GrillaEmpresas.ajax.reload(),$("#modalEmpresa").modal("hide")):DBR.ToastError(n.Message);DBR.blockUIStop()},error:function(n,t){console.log(t);DBR.blockUIStop()}})},GetEmpresa:function(n){DBR.blockUIStar();let t={IdEmpresa:n};$.ajax({url:urlGetEmpresa,type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify({request:t}),success:function(n){DBR.blockUIStop();Funciones.LimpiarCapos();$("#lblTitleAgregarEmpresa").html("Editar");$("#txtIdEmpresa").val(n.IdEmpresa);$("#txtRuc").val(n.Ruc);$("#txtRazonSocial").val(n.RazonSocial);$("#txtNombreComercial").val(n.NombreComercial);$("#txtDireccionFiscal").val(n.DireccionFiscal);$("#cboFrecuencia").val(n.Frecuencia);$("#txtLogin").val(n.Usuario);$("#txtNumeroDocumento").val(n.NumeroDocumento);$("#txtNombres").val(n.Nombres);$("#txtApellidoPaterno").val(n.ApellidoPaterno);$("#txtApellidoMaterno").val(n.ApellidoMaterno);$("#txtCorreo").val(n.Correo);$("#modalEmpresa").modal("show")},error:function(n,t){console.log(t);DBR.blockUIStop()}})},DeleteEmpresa:function(n){var t={};t.IdEmpresa=n;BootstrapDialog.show({title:"Confirmación",closeByBackdrop:!1,message:"¿Esta seguro de eliminar el registro?",size:BootstrapDialog.SIZE_SMALL,buttons:[{label:"Si",cssClass:"btn-primary btn-sm",action:function(n){DBR.blockUIStar();$.ajax({url:urlDeleteEmpresa,type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify({request:t}),success:function(t){DBR.blockUIStop();n.close();t.IsSuccess?(GrillaEmpresas.ajax.reload(),DBR.ToastSuccess(t.Message)):DBR.ToastError(t.Message)},error:function(n,t){DBR.blockUIStop();console.log(t)}})}},{label:"No",cssClass:"btn-default btn-sm",action:function(n){n.close()}}]})},GetPersona:function(){var n={};n.NumeroDocumento=$("#txtNumeroDocumento").val();DBR.blockUIStar();$.ajax({url:urlGetPersonaXdni,type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify({request:n}),success:function(n){DBR.blockUIStop();n.length>0?($("#txtNombres").val(n[0].Nombres),$("#txtApellidoPaterno").val(n[0].ApellidoPaterno),$("#txtApellidoMaterno").val(n[0].ApellidoMaterno),$("#txtLogin").val(n[0].NumeroDocumento),$("#txtCorreo").val(n[0].Correo),DBR.ToastSuccess("Persona encontrada")):($("#txtLogin").val(""),$("#txtNombres").val(""),$("#txtApellidoPaterno").val(""),$("#txtApellidoMaterno").val(""),$("#txtCorreo").val(""),DBR.ToastWarning("No se encontro persona"))},error:function(n,t){console.log(t)}})}},Funciones={LimpiarCapos:function(){DBR.limpiarCampo("#txtRuc");DBR.limpiarCampo("#txtRazonSocial");DBR.limpiarCampo("#txtNombreComercial");DBR.limpiarCampo("#txtDireccionFiscal");DBR.limpiarCampo("#cboFrecuencia");DBR.limpiarCampo("#txtLogin");DBR.limpiarCampo("#txtNumeroDocumento");DBR.limpiarCampo("#txtNombres");DBR.limpiarCampo("#txtApellidoPaterno");DBR.limpiarCampo("#txtApellidoMaterno");DBR.limpiarCampo("#txtCorreo")}};$(document).ready(function(){config.iniGrids.GridEmpresas();$("#txtRuc").numericInput({allowFloat:!1,allowNegative:!1});$("#txtNumeroDocumento").numericInput({allowFloat:!1,allowNegative:!1});$("#btnAgregar").on("click",function(){$("#lblTitleAgregarEmpresa").html("Agregar");$("#txtIdEmpresa").val(0);Funciones.LimpiarCapos();$("#modalEmpresa").modal("show")});$("#btnGuardarEmpresa").on("click",function(){let n=!0;DBR.validarCampo("#txtRuc")||(n=!1);DBR.validarCampo("#txtRazonSocial")||(n=!1);DBR.validarCampo("#txtNombreComercial")||(n=!1);DBR.validarCampo("#txtDireccionFiscal")||(n=!1);DBR.validarCampo("#txtLogin")||(n=!1);DBR.validarCampo("#txtNumeroDocumento")||(n=!1);DBR.validarCampo("#txtNombres")||(n=!1);DBR.validarCampo("#txtApellidoPaterno")||(n=!1);DBR.validarCampo("#txtApellidoMaterno")||(n=!1);DBR.validarCampo("#txtCorreo")||(n=!1);n&&Eventos.SaveEmpresa()});$("#btnSubirArchivo").on("click",function(){$("#fileDocumento").filestyle("clear");$("#fileDocumento").parent().removeClass("has-error");$("#fileDocumento").next().next().addClass("hide");$("#lblTitleAgregarDocumento").html("Subir documento");$("#txtIdDocumento2").val(0);$("#modalDocumento").modal("show")});$("#btnGuardarDucumento").on("click",function(){let n=!0;var t=document.getElementById("fileDocumento");t.files.length==0?($("#fileDocumento").parent().addClass("has-error"),$("#fileDocumento").next().next().removeClass("hide"),n=!1):($("#fileDocumento").parent().removeClass("has-error"),$("#fileDocumento").next().next().addClass("hide"),t.files[0].size>10485760&&(DBR.ToastWarning("Verifique que el archivo adjunto no supere el 10MB"),n=!1));n&&Eventos.SaveDocumento()});$("#btnActualizar").on("click",function(){GrillaDocumentos.ajax.reload()});$("#btnBuscarPorDni").on("click",function(){Eventos.GetPersona()})});