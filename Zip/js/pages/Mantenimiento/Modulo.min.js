var contenidoHtml="",config={ini:function(){$.ajaxSetup({type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:{}})},iniGrids:{GrillaModulo:function(){$("#gridModulos").DataTable({searching:!0,ordering:!1,processing:!0,serverSide:!0,destroy:!0,responsive:!0,autoWidth:!1,language:{url:"//cdn.datatables.net/plug-ins/1.10.15/i18n/Spanish.json"},ajax:{url:urlListModuloPaged,type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:function(n){var t={};return t.IdEvento=$("#txtIdEvento2").val(),JSON.stringify({page:n,request:t})}},columns:[{data:"Nombre",width:"40%"},{data:"Expositor",width:"40%"},{data:"Horas",sClass:"text-center",width:"10%"},{data:function(n){var t='<a data-toggle="tooltip1" data-placement="bottom" title="Editar" onclick="Eventos.GetModulo('+n.IdModulo+')" class="btn btn-primary btn-xs"><span class="glyphicon glyphicon-pencil" aria-hidden="true"><\/span><\/a>',i='<a data-toggle="tooltip1" data-placement="bottom" title="Eliminar" onclick="Eventos.DeleteModulo('+n.IdModulo+')" class="btn btn-primary btn-xs"><span class="glyphicon glyphicon-trash" aria-hidden="true"><\/span><\/a>';return t+" "+i},sClass:"text-center",width:"10%"}],drawCallback:function(){$('[data-toggle="tooltip1"]').tooltip()}})},GrillaLeccion:function(n){$('.grid-lecciones[data-modulo="'+n+'"]').DataTable({searching:!0,ordering:!1,processing:!0,serverSide:!0,destroy:!0,responsive:!0,autoWidth:!1,language:{url:"//cdn.datatables.net/plug-ins/1.10.15/i18n/Spanish.json"},ajax:{url:urlListLeccionPaged,type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:function(t){var i={};return i.IdModulo=n,JSON.stringify({page:t,request:i})}},columns:[{data:"NombreTipo",width:"10%"},{data:"Nombre",width:"70%"},{data:"Duracion",sClass:"text-center",width:"10%"},{data:function(n){var t='<a data-toggle="tooltip1" data-placement="bottom" title="Editar" onclick="Eventos.GetLeccion('+n.IdLeccion+')" class="btn btn-primary btn-xs"><span class="glyphicon glyphicon-pencil" aria-hidden="true"><\/span><\/a>',i='<a data-toggle="tooltip1" data-placement="bottom" title="Eliminar" onclick="Eventos.DeleteLeccion('+n.IdLeccion+')" class="btn btn-primary btn-xs"><span class="glyphicon glyphicon-trash" aria-hidden="true"><\/span><\/a>';return t+" "+i},sClass:"text-center",width:"10%"}],drawCallback:function(){$('[data-toggle="tooltip1"]').tooltip()}})}}},Eventos={ValoresIniciales:function(){DBR.blockUIStar();$.ajax({url:urlValoresIniciales,type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){DBR.LlenarCombo(n.TipoLeccion,"#ddlTipo",!1,!1,"Seleccione");DBR.blockUIStop()},error:function(n,t){console.log(t)}})},SaveModulo:function(){var n={};n.IdModulo=$("#txtIdModulo").val();n.IdEvento=$("#txtIdEvento").val();n.Nombre=$("#txtModuloNombre").val();n.Descripcion=$("#txtModuloDescripcion").val();n.Expositor=$("#txtModuloExpositor").val();n.Horas=$("#txtModuloHoras").val();n.Peso=$("#ddlModuloPeso").val();DBR.blockUIStar();$.ajax({url:urlSaveModulo,type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify({request:n}),success:function(n){DBR.blockUIStop();n.IsSuccess?($("#modalModulo").modal("hide"),DBR.ToastSuccess(n.Message),window.location.reload()):DBR.ToastError(n.Message)},error:function(n,t){DBR.blockUIStop();console.log(t)}})},GetModulo:function(n){$("#lblTitleModal").html("Editar");Funciones.LimpiarCamposModulo();var t={};t.IdModulo=n;DBR.blockUIStar();$.ajax({url:urlGetModulo,type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify({request:t}),success:function(n){DBR.blockUIStop();$("#txtIdModulo").val(n.IdModulo);$("#txtModuloNombre").val(n.Nombre);$("#txtModuloDescripcion").val(n.Descripcion);$("#txtModuloExpositor").val(n.Expositor);$("#txtModuloHoras").val(n.Horas);$("#ddlModuloPeso").val(n.Peso);$("#modalModulo").modal("show")},error:function(n,t){DBR.blockUIStop();console.log(t)}})},DeleteModulo:function(n){var t={};t.IdModulo=n;BootstrapDialog.show({title:"Confirmación",closeByBackdrop:!1,message:"¿Esta seguro de eliminar el registro?",size:BootstrapDialog.SIZE_SMALL,buttons:[{label:"Si",cssClass:"btn-primary btn-sm",action:function(n){DBR.blockUIStar();$.ajax({url:urlDeleteModulo,type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify({request:t}),success:function(t){DBR.blockUIStop();n.close();t.IsSuccess?(DBR.ToastSuccess(t.Message),window.location.reload()):DBR.ToastError(t.Message)},error:function(n,t){DBR.blockUIStop();console.log(t)}})}},{label:"No",cssClass:"btn-default btn-sm",action:function(n){n.close()}}]})},SaveLeccion:function(){var n={};n.IdLeccion=$("#txtIdLeccion").val();n.IdModulo=$("#txtIdModuloLeccion").val();n.Tipo=$("#ddlTipo").val();n.Nombre=$("#txtLeccionNombre").val();n.Duracion=$("#txtDuracion").val();n.Descripcion=contenidoHtml;n.TipoUrl=$("input[name='rTipoUrl']:checked").val();n.Url=n.TipoUrl==1?$("#txtUrlVideo").val():$("#txtIframeVideo").val();n.Orden=$("#txtOrden").val();n.Peso=$("#ddlLeccionPeso").val();DBR.blockUIStar();$.ajax({url:urlSaveLeccion,type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify({request:n}),success:function(t){DBR.blockUIStop();t.IsSuccess?($('.grid-lecciones[data-modulo="'+n.IdModulo+'"]').DataTable().ajax.reload(),$("#modalLeccion").modal("hide"),DBR.ToastSuccess(t.Message)):DBR.ToastError(t.Message)},error:function(n,t){DBR.blockUIStop();console.log(t)}})},GetLeccion:function(n){$("#lblTitleLeccion").html("Editar");Funciones.LimpiarCamposLeccion();var t={};t.IdLeccion=n;DBR.blockUIStar();$.ajax({url:urlGetLeccion,type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify({request:t}),success:function(n){if(DBR.blockUIStop(),$("#txtIdLeccion").val(n.IdLeccion),$("#ddlTipo").val(n.Tipo),$("#txtLeccionNombre").val(n.Nombre),$("#txtDuracion").val(n.Duracion),$("input[name=rTipoUrl][value="+n.TipoUrl+"]").iCheck("check"),n.TipoUrl==1?($("#txtUrlVideo").val(n.UrlVideo),$("#txtIframeVideo").val("")):($("#txtUrlVideo").val(""),$("#txtIframeVideo").val(n.UrlVideo)),$("#txtOrden").val(n.Orden),n.Tipo==3){var t=$("#txtIdEvento").val();window.location.href=urlCuestionario+"?idLeccion="+n.IdLeccion+"&idCurso="+t}else n.Descripcion==null&&(n.Descripcion="<p><\/p>"),n.Descripcion=n.Descripcion.replace(/div/g,"p"),CKEDITOR.instances.txtMensajeCompleto.setData(n.Descripcion),contenidoHtml=n.Descripcion,$("#modalLeccion").modal("show")},error:function(n,t){DBR.blockUIStop();console.log(t)}})},DeleteLeccion:function(n){var t={};t.IdLeccion=n;BootstrapDialog.show({title:"Confirmación",closeByBackdrop:!1,message:"¿Esta seguro de eliminar el registro?",size:BootstrapDialog.SIZE_SMALL,buttons:[{label:"Si",cssClass:"btn-primary btn-sm",action:function(n){DBR.blockUIStar();$.ajax({url:urlDeleteLeccion,type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify({request:t}),success:function(t){DBR.blockUIStop();n.close();t.IsSuccess?($("#gridLeccion").DataTable().ajax.reload(),DBR.ToastSuccess(t.Message)):DBR.ToastError(t.Message)},error:function(n,t){DBR.blockUIStop();console.log(t)}})}},{label:"No",cssClass:"btn-default btn-sm",action:function(n){n.close()}}]})}},Funciones={LimpiarCamposModulo:function(){DBR.limpiarCampo("#txtModuloNombre");DBR.limpiarCampo("#txtModuloDescripcion");DBR.limpiarCampo("#txtModuloExpositor");DBR.limpiarCampo("#txtModuloHoras");DBR.limpiarCampo("#ddlModuloPeso")},LimpiarCamposLeccion:function(){DBR.limpiarCampo("#ddlTipo");DBR.limpiarCampo("#txtLeccionNombre");DBR.limpiarCampo("#txtDuracion");DBR.limpiarCampo("#txtUrlVideo");DBR.limpiarCampo("#txtOrden");DBR.limpiarCampo("#ddlLeccionPeso");CKEDITOR.instances.txtMensajeCompleto.setData("");contenidoHtml="";$("input[name=rTipoUrl][value=1]").iCheck("check");$("#txtUrlVideo").val("");$("#txtIframeVideo").val("");$("#conteinerUrl").removeClass("hide");$("#conteinerIframa").addClass("hide")}};$(document).ready(function(){var n,t;$.fn.modal.Constructor.prototype.enforceFocus=function(){};n=window.location.origin+"/Mantenimiento/Curso";$("ul.sidebar-menu a").filter(function(){return this.href==n}).parent().siblings().removeClass("active").end().addClass("active");$("ul.treeview-menu a").filter(function(){return this.href==n}).parentsUntil(".sidebar-menu > .treeview-menu").siblings().removeClass("active").end().addClass("active");config.iniGrids.GrillaModulo();Eventos.ValoresIniciales();$.each($(".grid-lecciones"),function(n,t){config.iniGrids.GrillaLeccion($(t).data("modulo"))});$(".minimal").iCheck({checkboxClass:"icheckbox_square-blue",radioClass:"iradio_square-blue"});$("#txtFecha").datepicker({autoclose:!0,language:"es",format:"dd/mm/yyyy",startDate:new Date});$("#txtOrden").numericInput({allowFloat:!1,allowNegative:!1});$("#txtModuloHoras").numericInput({allowFloat:!1,allowNegative:!1});$("#txtDuracion").numericInput({allowFloat:!1,allowNegative:!1});$("input[name='rTipoUrl']").on("ifChanged",function(){$(this).val()==1?($("#conteinerUrl").removeClass("hide"),$("#conteinerIframa").addClass("hide")):($("#conteinerUrl").addClass("hide"),$("#conteinerIframa").removeClass("hide"))});$("#btnAgregarModulo").on("click",function(){$("#lblTitleModal").html("Agregar");$("#txtIdModulo").val(0);Funciones.LimpiarCamposModulo();$("#modalModulo").modal("show")});$(".btn-edit-modulo").on("click",function(){var n=$(this).data("modulo");Eventos.GetModulo(n)});$("#btnGuardarModulo").on("click",function(){var n=!0;DBR.validarCampo("#txtModuloNombre")||(n=!1);DBR.validarCampo("#txtModuloDescripcion")||(n=!1);DBR.validarCampo("#txtModuloExpositor")||(n=!1);DBR.validarCampo("#txtModuloHoras")||(n=!1);DBR.validarCampo("#ddlModuloPeso")||(n=!1);n&&Eventos.SaveModulo()});$("button.btn-delete-modulo").on("click",function(){var n=$(this).data("modulo");Eventos.DeleteModulo(n)});$(".btn-agregar-leccion").on("click",function(){$("#lblTitleLeccion").html("Agregar");$("#txtIdModuloLeccion").val($(this).data("modulo"));$("#txtIdLeccion").val(0);$("div.div-leccion").show();Funciones.LimpiarCamposLeccion();$("#modalLeccion").modal("show")});$("#ddlTipo").change(function(){$(this).val()==3?($("div.div-leccion").hide(),$("div.div-peso").show()):($("div.div-leccion").show(),$("div.div-peso").hide())});$("#btnGuardarLeccion").on("click",function(){var n=!0;DBR.validarCampo("#ddlTipo")||(n=!1);n&&$("#ddlTipo").val()!=3?DBR.validarCampo("#txtDuracion")||(n=!1):DBR.validarCampo("#ddlLeccionPeso")||(n=!1);DBR.validarCampo("#txtLeccionNombre")||(n=!1);DBR.validarCampo("#txtOrden")||(n=!1);n&&Eventos.SaveLeccion()});t=CKEDITOR.replace("txtMensajeCompleto",{height:350,filebrowserBrowseUrl:urlFileServerBrowse,filebrowserUploadUrl:urlSaveFileServerCkEditor});t.on("change",function(n){contenidoHtml=n.editor.getData()})});