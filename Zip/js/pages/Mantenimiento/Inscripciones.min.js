var PrimeraCarga=0,contenidoHtml="",config={iniGrids:{GrillaInscripciones:function(){$("#gridInscripciones").DataTable({searching:!0,ordering:!1,processing:!0,serverSide:!0,destroy:!0,stateSave:!0,language:{url:"//cdn.datatables.net/plug-ins/1.10.15/i18n/Spanish.json"},ajax:{url:urlListInscripcion,type:"POST",datatype:"json",data:{IdEvento:function(){return $("#cboEventosActivos").val()}}},columns:[{data:function(n){return n.TipoInscripcion==1?"PART":"EXPO"},sClass:"text-center"},{data:"Nombre"},{data:"NumeroDocumento",sClass:"text-center"},{data:"Celular"},{data:"NombreEstadoPago"},{data:"NombreTipoPago"},{data:"Modalidad"},{data:function(n){return n.Monto==null?"":n.Monto.toFixed(2)},sClass:"text-right"},{data:function(n){return parseJsonDate(n.FechaOperacion)},sClass:"text-center"},{data:"NumeroOperacion",sClass:"text-center"},{data:function(n){return n.Certificado==null?"Pendiente":"Cargado"},sClass:"text-center"},{data:function(n){return n.Nota==null?"":n.Nota.toFixed(2)},sClass:"text-center"},{data:function(n){var u='<a data-toggle="tooltip1" data-placement="bottom" title="Editar" onclick="Eventos.GetInscripcion('+n.IdInscripcion+')" class="btn btn-primary btn-xs"><span class="glyphicon glyphicon-pencil" aria-hidden="true"><\/span><\/a>',t='<a data-toggle="tooltip1" data-placement="bottom" title="Entrega certificado" onclick="Eventos.EntregaCertificado('+n.IdInscripcion+')" class="btn btn-primary btn-xs"><span class="glyphicon glyphicon-list-alt" aria-hidden="true"><\/span><\/a>',f='<a data-toggle="tooltip1" data-placement="bottom" title="Acceso usuario" onclick="Eventos.GetEventoUsuario('+IsNull(n.IdUsuario,0)+","+n.IdPersona+')" class="btn btn-primary btn-xs"><span class="fa fa-user" aria-hidden="true"><\/span><\/a>',e='<a data-toggle="tooltip1" data-placement="bottom" title="Enviar correo" onclick="Eventos.EnviarCorreoIndividual('+n.IdPersona+",'"+n.Nombres+" "+n.ApellidoPaterno+" "+n.ApellidoMaterno+"','"+n.Correo+'\')" class="btn btn-primary btn-xs"><span class="fa fa-send" aria-hidden="true"><\/span><\/a>',i='<a data-toggle="tooltip1" data-placement="bottom" title="Eliminar" onclick="Eventos.DeleteInscripcion('+n.IdInscripcion+')" class="btn btn-primary btn-xs"><span class="glyphicon glyphicon-trash" aria-hidden="true"><\/span><\/a>';let r=n.TipoInscripcion==1?n.NombreCertificadoImprimir:n.NombreCertificadoExpositor;var o='<a data-toggle="tooltip1" data-placement="bottom" title="Ver certificado" onclick="Eventos.VerCertificado('+n.IdInscripcion+","+n.IdEvento+","+n.IdPersona+","+n.TipoInscripcion+","+n.NumeroCertificado+",'"+n.rowguid+"','"+r+"','"+n.Nombres+"','"+n.ApellidoPaterno+"','"+n.ApellidoMaterno+"','"+n.TipoOcupacionAbreviatura+"',"+n.Nota+","+n.DetallarCertificado+')" class="btn btn-primary btn-xs"><span class="glyphicon glyphicon-eye-open" aria-hidden="true"><\/span><\/a>',s='<a data-toggle="tooltip1" data-placement="bottom" title="Cargar automática" onclick="Eventos.CargarCertificadoUtomatico('+n.IdInscripcion+","+n.IdEvento+","+n.IdPersona+","+n.TipoInscripcion+","+n.NumeroCertificado+",'"+n.rowguid+"','"+r+"','"+n.Nombres+"','"+n.ApellidoPaterno+"','"+n.ApellidoMaterno+"','"+n.TipoOcupacionAbreviatura+"',"+n.Nota+","+n.DetallarCertificado+')" class="btn btn-primary btn-xs"><span class="fa fa-file-pdf-o" aria-hidden="true"><\/span><\/a>',h='<a data-toggle="tooltip1" data-placement="bottom" title="Cargar manual" onclick="Eventos.CargarCertificado('+n.IdInscripcion+')" class="btn btn-primary btn-xs"><span class="fa fa-cloud-upload" aria-hidden="true"><\/span><\/a>';return n.EntregaCertificado&&(t="",i=""),t+" "+o+" "+s+" "+h+" "+f+" "+e+" "+u+" "+i},sClass:"text-center"}],drawCallback:function(){$('[data-toggle="tooltip1"]').tooltip({container:"body"})}})}}},Eventos={ListEventoCombo:function(){$.ajax({url:urlListEventoCombo,type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){DBR.LlenarCombo(n,"#cboEvento",!0,!1);var t=n[n.length-1].Value;$("#cboEvento").val(t).trigger("change")},error:function(n,t){console.log(t)}})},ValoresIniciales:function(){DBR.blockUIStar();$.ajax({url:urlValoresIniciales,type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){DBR.LlenarCombo(n.EstadoPago,"#cboEstadoPago",!1,!1,"Seleccione");DBR.LlenarCombo(n.TipoPago,"#cboTipoPago",!1,!1,"Seleccione");DBR.LlenarCombo(n.Ocupacion,"#cboTipoOcupacion",!1,!1,"Seleccione");DBR.LlenarCombo(n.Profesion,"#cboProfesion",!1,!1,"Seleccione");DBR.LlenarCombo(n.Evento,"#cboEventosActivos",!0,!1,"Seleccione evento");DBR.LlenarCombo(n.Modalidad,"#cboModalidad",!0,!1,"Seleccione");DBR.LlenarCombo(n.Pais,"#cboPais",!0,!1,"Seleccione");DBR.blockUIStop()},error:function(n,t){console.log(t)}})},SaveInscripcion:function(){var t={},n;t.IdInscripcion=$("#txtIdInscripcion").val();t.IdEvento=$("#cboEventosActivos").val();t.EstadoPago=$("#cboEstadoPago").val();t.TipoPago=$("#cboTipoPago").val();t.TipoModalidad=$("#cboModalidad").val();t.Monto=$("#txtMonto").val();t.NombreBanco=$.trim($("#txtNombreBanco").val().toUpperCase());t.FechaOperacion=$("#txtFechaOperacion").val();t.NumeroOperacion=$.trim($("#txtNumeroOperacion").val().toUpperCase());t.Nota=$("#txtNota").val();t.TipoInscripcion=$("#cboTipoInscripcion").val();t.Ruc=$("#txtRuc").val();n={};n.Nombres=$.trim($("#txtNombres").val().toUpperCase());n.ApellidoPaterno=$.trim($("#txtApellidoPaterno").val().toUpperCase());n.ApellidoMaterno=$.trim($("#txtApellidoMaterno").val().toUpperCase());n.NumeroDocumento=$.trim($("#txtDni").val());n.TipoOcupacion=$("#cboTipoOcupacion").val();n.CIP=$.trim($("#txtCip").val());n.Celular=$.trim($("#txtCelular").val());n.Correo=$.trim($("#txtCorreo").val().toUpperCase());n.DescripcionOcupacion=$.trim($("#txtDescripcionOcupacion").val().toUpperCase());n.IdProfesion=$("#cboProfesion").val();n.IdPais=$("#cboPais").val();n.Ciudad=$("#txtCiudad").val().toUpperCase();DBR.blockUIStar();$.ajax({url:urlSaveInscripcion,type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify({request1:t,request2:n}),success:function(n){DBR.blockUIStop();n.IsSuccess?($("#gridInscripciones").DataTable().ajax.reload(null,!1),$("#modalInscripcion").modal("hide"),DBR.ToastSuccess(n.Message)):DBR.ToastError(n.Message)},error:function(n,t){DBR.blockUIStop();console.log(t)}})},DeleteInscripcion:function(n){var t={};t.IdInscripcion=n;BootstrapDialog.show({title:"Confirmación",closeByBackdrop:!1,message:"¿Esta seguro de eliminar el registro?",size:BootstrapDialog.SIZE_SMALL,buttons:[{label:"Si",cssClass:"btn-primary btn-sm",action:function(n){DBR.blockUIStar();$.ajax({url:urlDeleteInscripcion,type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify({request:t}),success:function(t){DBR.blockUIStop();n.close();t.IsSuccess?($("#gridInscripciones").DataTable().ajax.reload(null,!1),DBR.ToastSuccess(t.Message)):DBR.ToastError(t.Message)},error:function(n,t){DBR.blockUIStop();console.log(t)}})}},{label:"No",cssClass:"btn-default btn-sm",action:function(n){n.close()}}]})},EntregaCertificado:function(n){var t={};t.IdInscripcion=n;BootstrapDialog.show({title:"Confirmación",closeByBackdrop:!1,message:"¿Marcar certificado entregado?",size:BootstrapDialog.SIZE_SMALL,buttons:[{label:"Si",cssClass:"btn-primary btn-sm",action:function(n){DBR.blockUIStar();$.ajax({url:urlUpdateEntregaCertificadoInscripcion,type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify({request:t}),success:function(t){DBR.blockUIStop();n.close();t.IsSuccess?($("#gridInscripciones").DataTable().ajax.reload(null,!1),DBR.ToastSuccess(t.Message)):DBR.ToastError(t.Message)},error:function(n,t){DBR.blockUIStop();console.log(t)}})}},{label:"No",cssClass:"btn-default btn-sm",action:function(n){n.close()}}]})},GetPersona:function(){var n={};n.NumeroDocumento=$("#txtDni").val();DBR.blockUIStar();$.ajax({url:urlGetPersonaXdni,type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify({request:n}),success:function(n){DBR.blockUIStop();n.length>0?($("#txtNombres").val(n[0].Nombres),$("#txtApellidoPaterno").val(n[0].ApellidoPaterno),$("#txtApellidoMaterno").val(n[0].ApellidoMaterno),$("#cboTipoOcupacion").val(n[0].TipoOcupacion),$("#txtCip").val(n[0].CIP),$("#txtCelular").val(n[0].Celular),$("#txtCorreo").val(n[0].Correo),$("#txtDescripcionOcupacion").val(n[0].DescripcionOcupacion),n[0].IdProfesion!=null?$("#cboProfesion").val(n[0].IdProfesion).trigger("change"):$("#cboProfesion").val(0).trigger("change"),n[0].IdPais!=null?$("#cboPais").val(n[0].IdPais).trigger("change"):$("#cboPais").val(0).trigger("change"),$("#txtCiudad").val(n[0].Ciudad),DBR.ToastSuccess("Persona encontrada")):($("#txtNombres").val(""),$("#txtApellidoPaterno").val(""),$("#txtApellidoMaterno").val(""),$("#txtOcupacion").val(""),$("#txtCip").val(""),$("#txtCelular").val(""),$("#txtCorreo").val(""),$("#txtDescripcionOcupacion").val(""),$("#cboProfesion").val(0).trigger("change"),$("#cboPais").val(0).trigger("change"),$("#txtCiudad").val(""),DBR.ToastWarning("No se encontro persona"))},error:function(n,t){console.log(t)}})},GetPersonaXcip:function(){var n={};n.Cip=$("#txtCip").val();DBR.blockUIStar();$.ajax({url:urlGetPersonaXcip,type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify({request:n}),success:function(n){DBR.blockUIStop();n.length>0?($("#txtDni").val(n[0].NumeroDocumento),$("#txtNombres").val(n[0].Nombres),$("#txtApellidoPaterno").val(n[0].ApellidoPaterno),$("#txtApellidoMaterno").val(n[0].ApellidoMaterno),$("#cboTipoOcupacion").val(n[0].TipoOcupacion),$("#txtCip").val(n[0].CIP),$("#txtCelular").val(n[0].Celular),$("#txtCorreo").val(n[0].Correo),$("#txtDescripcionOcupacion").val(n[0].DescripcionOcupacion),n[0].IdProfesion!=null?$("#cboProfesion").val(n[0].IdProfesion).trigger("change"):$("#cboProfesion").val(0).trigger("change"),n[0].IdPais!=null?$("#cboPais").val(n[0].IdPais).trigger("change"):$("#cboPais").val(0).trigger("change"),$("#txtCiudad").val(n[0].Ciudad),DBR.ToastSuccess("Persona encontrada")):($("#txtDni").val(""),$("#txtNombres").val(""),$("#txtApellidoPaterno").val(""),$("#txtApellidoMaterno").val(""),$("#txtOcupacion").val(""),$("#txtCelular").val(""),$("#txtCorreo").val(""),$("#txtDescripcionOcupacion").val(""),$("#cboProfesion").val(0).trigger("change"),$("#cboPais").val(0).trigger("change"),$("#txtCiudad").val(""),DBR.ToastWarning("No se encontro persona"))},error:function(n,t){console.log(t)}})},GetInscripcion:function(n){var t={};t.IdInscripcion=n;Funciones.LimpiarCamposInscripcion();DBR.blockUIStar();$.ajax({url:urlGetInscripcion,type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify({request:t}),success:function(t){DBR.blockUIStop();$("#txtIdInscripcion").val(n);$("#txtDni").val(t[0].NumeroDocumento);$("#txtNombres").val(t[0].Nombres);$("#txtApellidoPaterno").val(t[0].ApellidoPaterno);$("#txtApellidoMaterno").val(t[0].ApellidoMaterno);$("#cboUniversidad").val(t[0].IdUniversidad).trigger("change");$("#cboTipoOcupacion").val(t[0].TipoOcupacion);$("#txtCip").val(t[0].CIP);$("#txtCelular").val(t[0].Celular);$("#txtCorreo").val(t[0].Correo);$("#txtDescripcionOcupacion").val(t[0].DescripcionOcupacion);t[0].IdPais!=null?$("#cboPais").val(t[0].IdPais).trigger("change"):$("#cboPais").val(0).trigger("change");$("#txtCiudad").val(t[0].Ciudad);$("#cboEstadoPago").val(t[0].EstadoPago);$("#cboTipoPago").val(t[0].TipoPago);t[0].IdProfesion!=null?$("#cboProfesion").val(t[0].IdProfesion).trigger("change"):$("#cboProfesion").val(0).trigger("change");$("#cboModalidad").val(t[0].TipoModalidad).trigger("change");$("#txtMonto").val(t[0].Monto==null?"":t[0].Monto.toFixed(2));$("#txtNombreBanco").val(t[0].NombreBanco);$("#txtFechaOperacion").datepicker("setDate",parseJsonDate(t[0].FechaOperacion));$("#txtNumeroOperacion").val(t[0].NumeroOperacion);$("#txtNota").val(t[0].Nota);$("#cboTipoInscripcion").val(t[0].TipoInscripcion);$("#txtRuc").val(t[0].Ruc);$("#modalInscripcion").modal("show")},error:function(n,t){console.log(t)}})},VerCertificado:function(n,t,i,r,u,f,e,o,s,h,c,l,a){var v={},p,y;v.IdInscripcion=n;v.IdEvento=t;v.IdPersona=i;v.NumeroCertificado=u;v.rowguid=f;v.Nota=l;v.TipoInscripcion=r;p={};p.DocumentoCertificadoImprimir=e;p.IdEvento=t;p.DetallarCertificado=a;y={};y.ApellidoPaterno=s;y.ApellidoMaterno=h;y.Nombres=o;y.TipoOcupacionAbreviatura=c;DBR.blockUIStar();$.ajax({url:urlVerPdfCertificado,type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify({request:v,documentos:p,persona:y}),success:function(n){if(DBR.blockUIStop(),n.IsSuccess){UrlViewPdfIframe=UrlViewPdfIframe.replace("/Mantenimiento","");var t=UrlViewPdfIframe+"/pdfjs/web/viewer.html?file="+n.Message;$("#visorPdf").attr("src",t);$("#modalVerDocumento").modal("show")}else DBR.ToastError(n.Message)},error:function(n){DBR.blockUIStop();console.log(n.responseText)}})},CargarCertificadoUtomatico:function(n,t,i,r,u,f,e,o,s,h,c,l,a){var v={},p,y;v.IdInscripcion=n;v.IdEvento=t;v.IdPersona=i;v.NumeroCertificado=u;v.rowguid=f;v.Nota=l;v.TipoInscripcion=r;p={};p.DocumentoCertificadoImprimir=e;p.IdEvento=t;p.DetallarCertificado=a;y={};y.ApellidoPaterno=s;y.ApellidoMaterno=h;y.Nombres=o;y.TipoOcupacionAbreviatura=c;DBR.blockUIStar();$.ajax({url:urlCargarPdfCertificadoUtomatico,type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify({request:v,documentos:p,persona:y}),success:function(n){DBR.blockUIStop();n.IsSuccess?DBR.ToastSuccess(n.Message):DBR.ToastError(n.Message)},error:function(n){DBR.blockUIStop();console.log(n.responseText)}})},CargarCertificado:function(n){$("#txtIdInscripcionCertificado").val(n);$("#fileCertificadoImprimir").parent().removeClass("has-error");$("#fileCertificadoImprimir").next().next().addClass("hide");$("#fileCertificadoImprimir").filestyle("clear");$("#modalCargaCertificado").modal("show")},SaveCertificadoFirmado:function(){var t=document.getElementById("fileCertificadoImprimir"),n=new FormData;n.append("documento",t.files[0]);n.append("IdInscripcion",$("#txtIdInscripcionCertificado").val());DBR.blockUIStar();$.ajax({url:urlSaveCertificadoFirmado,type:"POST",dataType:"json",cache:!1,contentType:!1,processData:!1,data:n}).done(function(n){DBR.blockUIStop();n.IsSuccess?($("#gridInscripciones").DataTable().ajax.reload(null,!1),$("#modalCargaCertificado").modal("hide"),DBR.ToastSuccess(n.Message)):DBR.ToastError(n.Message)}).fail(function(n){DBR.blockUIStop();console.log(n)})},SaveFileServer:function(){var t=document.getElementById("inputFileServer"),n=new FormData;n.append("documento",t.files[0]);DBR.blockUIStar();$.ajax({url:urlSaveFileServer,type:"POST",dataType:"json",cache:!1,contentType:!1,processData:!1,data:n}).done(function(n){DBR.blockUIStop();$("#inputFileServer").filestyle("clear");n.IsSuccess?$("#txtLink").val(n.Message):($("#txtLink").val(""),GISSAT.ToastError(n.Message))}).fail(function(n){DBR.blockUIStop();console.log(n)})},EnviarCorreo:function(){var n={};n.IdEvento=$("#cboEventosActivos").val();BootstrapDialog.show({title:"Confirmación",closeByBackdrop:!1,message:"Se enviar correo a todas las personas inscritas <\/br><\/br>¿Esta seguro continuar?",size:BootstrapDialog.SIZE_SMALL,buttons:[{label:"Si",cssClass:"btn-primary btn-sm",action:function(t){DBR.blockUIStar("Enviando...");$.ajax({url:urlSaveCorreoInscritos,type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify({request1:n}),success:function(n){DBR.blockUIStop();t.close();n.IsSuccess?DBR.ToastSuccess(n.Message):DBR.ToastError(n.Message)},error:function(n,t){DBR.blockUIStop();console.log(t)}})}},{label:"No",cssClass:"btn-default btn-sm",action:function(n){n.close()}}]})},EnviarCorreoIndividual:function(n,t,i){var u={},r;u.IdEvento=$("#cboEventosActivos").val();r={};r.IdPersona=n;r.NombreCompleto=t;r.Correo=i;DBR.blockUIStar("Enviando...");$.ajax({url:urlSaveCorreoInscritosIndividual,type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify({request1:u,request:r}),success:function(n){DBR.blockUIStop();n.IsSuccess?DBR.ToastSuccess(n.Message):DBR.ToastError(n.Message)},error:function(n,t){DBR.blockUIStop();console.log(t)}})},GetEventoUsuario:function(n,t){if($("#txtIdUsuario").val(n),n==0)Eventos.CrarUsuarioNuevo(t);else{var i={};i.IdUsuario=n;i.IdEvento=$("#cboEventosActivos").val();DBR.blockUIStar();$.ajax({url:urlGetEventoUsuario,type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify({request:i}),success:function(n){DBR.blockUIStop();Funciones.LimpiarCamposEventoUsuario();n=="NULL"?($("#txtIdEventoUsuario").val(0),$("#txtFechaInicio").datepicker("setDate",""),$("#txtFechaFin").datepicker("setDate","")):($("#txtIdEventoUsuario").val(n.IdEventoUsuario),$("#txtFechaInicio").datepicker("setDate",parseJsonDate(n.FechaInicio)),$("#txtFechaFin").datepicker("setDate",parseJsonDate(n.FechaFin)));$("#modalUsuarioEvento").modal("show")},error:function(n,t){DBR.blockUIStop();console.log(t)}})}},SaveEventoUsuario:function(){var n={},t;n.IdEventoUsuario=$("#txtIdEventoUsuario").val();n.IdEvento=$("#cboEventosActivos").val();n.IdUsuario=$("#txtIdUsuario").val();n.FechaInicio=$("#txtFechaInicio").val();n.FechaFin=$("#txtFechaFin").val();console.log(n);t=[];DBR.blockUIStar();$.ajax({url:urlSaveEventoUsuario,type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify({request:n,requestVideos:t}),success:function(n){DBR.blockUIStop();n.IsSuccess?($("#modalUsuarioEvento").modal("hide"),DBR.ToastSuccess(n.Message)):DBR.ToastError(n.Message)},error:function(n,t){DBR.blockUIStop();console.log(t)}})},CrarUsuarioNuevo:function(n){let t={};t.IdPersona=n;BootstrapDialog.show({title:"Confirmación",closeByBackdrop:!1,message:"No se encontro usuario registrado <br/><br/> ¿Desea crear un usuario para esta persona?",size:BootstrapDialog.SIZE_SMALL,buttons:[{label:"Si",cssClass:"btn-primary btn-sm",action:function(n){DBR.blockUIStar();$.ajax({url:urlSaveUsuarioAutomativo,type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify({request:t}),success:function(t){DBR.blockUIStop();t.IsSuccess?(n.close(),DBR.ToastSuccess(t.Message),$("#gridInscripciones").DataTable().ajax.reload(null,!1),$("#txtIdUsuario").val(t.Codigo),$("#modalUsuarioEvento").modal("show")):DBR.ToastError(t.Message)},error:function(n,t){DBR.blockUIStop();console.log(t)}})}},{label:"No",cssClass:"btn-default btn-sm",action:function(n){n.close()}}]})},GetEventoCorreo:function(){var n={};n.IdEvento=$("#cboEventosActivos").val();DBR.blockUIStar();$.ajax({url:urlGeEventoCorreoByIdEvento,type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify({request:n}),success:function(n){DBR.blockUIStop();n!="NULL"?($("#txtIdEventoCorreo").val(n.IdEventoCorreo),$("#txtAsuntoMensaje").val(n.Asunto),$("#txtCorreoOrigen").val(n.Origen),$("#txtNombreOrigen").val(n.NombreOrigen),CKEDITOR.instances.txtMensajeCompleto.setData(n.Mensaje),contenidoHtml=n.Mensaje):($("#txtIdEventoCorreo").val(0),$("#txtAsuntoMensaje").val(""),$("#txtCorreoOrigen").val(CorreoOrigen),$("#txtNombreOrigen").val(NombreCorreoOrigen),CKEDITOR.instances.txtMensajeCompleto.setData(""),contenidoHtml="")},error:function(n,t){DBR.blockUIStop();console.log(t)}})},SaveEventoCorreo:function(){var n={};n.IdEventoCorreo=$("#txtIdEventoCorreo").val();n.IdEvento=$("#cboEventosActivos").val();n.Asunto=$.trim($("#txtAsuntoMensaje").val().toUpperCase());n.Origen=$.trim($("#txtCorreoOrigen").val().toLowerCase());n.NombreOrigen=$.trim($("#txtNombreOrigen").val().toUpperCase());n.Mensaje=contenidoHtml;DBR.blockUIStar();$.ajax({url:urlSaveEventoCorreo,type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify({request:n}),success:function(n){DBR.blockUIStop();n.IsSuccess?(DBR.ToastSuccess(n.Message),$("#modalAgregarCorreo").modal("hide")):DBR.ToastError(n.Message)},error:function(n,t){DBR.blockUIStop();console.log(t)}})}},Funciones={LimpiarCamposInscripcion:function(){$("#formInscripcion .validar").each(function(){DBR.limpiarCampo(this)});$("#cboTipoInscripcion").val(1);$("#txtCip").val("");$("#txtNombreBanco").val("");$("#txtFechaOperacion").datepicker("setDate","");$("#txtNumeroOperacion").val("");$("#txtDescripcionOcupacion").val("");$("#txtCiudad").val("");$("#txtNota").val("");$("#txtRuc").val("")},LimpiarControles:function(){DBR.limpiarCampo("#txtAsuntoMensaje");DBR.limpiarCampo("#txtCorreoOrigen");DBR.limpiarCampo("#txtNombreOrigen");$("#inputFileServer").filestyle("clear");$("#txtLink").val("");CKEDITOR.instances.txtMensajeCompleto.setData("");contenidoHtml=""},LimpiarCamposEventoUsuario:function(){DBR.limpiarCampo("#txtFechaInicio");DBR.limpiarCampo("#txtFechaFin")}};$(document).ready(function(){$.fn.modal.Constructor.prototype.enforceFocus=function(){};$.fn.modal.Constructor.prototype.enforceFocus=function(){};Eventos.ValoresIniciales();config.iniGrids.GrillaInscripciones();$("#txtFecha").datepicker({autoclose:!0,language:"es",format:"dd/mm/yyyy",startDate:new Date});$("#txtFechaOperacion").datepicker({autoclose:!0,language:"es",format:"dd/mm/yyyy"});$("#txtDni").numericInput({allowFloat:!1,allowNegative:!1});$("#txtCelular").numericInput({allowFloat:!1,allowNegative:!1});$("#txtCip").numericInput({allowFloat:!1,allowNegative:!1});$("#txtMonto").numericInput({allowFloat:!0,allowNegative:!1});$("#txtNota").numericInput({allowFloat:!0,allowNegative:!1,max:20});$("#txtRuc").numericInput({allowFloat:!0,allowNegative:!1});$("#cboProfesion").select2();$("#cboPais").select2();$("#txtFechaInicio").datepicker({autoclose:!0,language:"es",format:"dd/mm/yyyy"});$("#txtFechaFin").datepicker({autoclose:!0,language:"es",format:"dd/mm/yyyy"});$("#txtDni").keypress(function(n){n.which==13&&Eventos.GetPersona()});$("#txtCip").keypress(function(n){n.which==13&&Eventos.GetPersonaXcip()});$("#btnBuscarPorDni").on("click",function(){var n=$("#txtDni").val().length;n>=8?Eventos.GetPersona():DBR.ToastWarning("El dni no puede ser menos a 8 dígitos")});$("#btnBuscarPorCip").on("click",function(){var n=$("#txtCip").val().length;n>4?Eventos.GetPersonaXcip():DBR.ToastWarning("El CIP no puede ser menos a 4 dígitos")});$("#cboEvento").on("change",function(){config.iniGrids.GrillaInscripciones()});$("#btnAgregarInscripcion").on("click",function(){$("#lblTitleAgregarInscripcion").html("Agregar");$("#txtIdInscripcion").val(0);DBR.validarCampo("#cboEventosActivos")?(Funciones.LimpiarCamposInscripcion(),$("#modalInscripcion").modal("show")):DBR.ToastWarning("Seleccione un evento")});$("#btnGuardarInscripcion").on("click",function(){var n=!0;$("#formInscripcion .validar").each(function(){DBR.validarCampo(this)||(n=!1)});$.trim($("#txtDni").val())!=""&&$.trim($("#txtDni").val()).length<8&&(DBR.ToastWarning("El dni no puede ser menos a 8 dígitos"),n=!1);n&&Eventos.SaveInscripcion()});$("#btnDescargarExcel").on("click",function(){let n=$("#cboEventosActivos").val(),t=$("#cboEventosActivos option:selected").text();window.location.href=urlDescargarPersonasInscritas+"?IdEvento="+n+"&NombreEvento="+t});$("#cboEventosActivos").on("change",function(){$("#gridInscripciones").DataTable().ajax.reload(null,!1)});$("#btnGuardarCertificado").on("click",function(){var n=!0,t=document.getElementById("fileCertificadoImprimir");t.files.length==0?($("#fileCertificadoImprimir").parent().addClass("has-error"),$("#fileCertificadoImprimir").next().next().removeClass("hide"),n=!1):($("#fileCertificadoImprimir").parent().removeClass("has-error"),$("#fileCertificadoImprimir").next().next().addClass("hide"),t.files[0].length>4194304&&(DBR.ToastWarning("Verifique que el archivo adjunto no supere el 4MB"),n=!1));n&&Eventos.SaveCertificadoFirmado()});$("#inputFileServer").on("change",function(){var n=document.getElementById("inputFileServer");if(n.files.length==0)return GISSAT.ToastWarning("No se selecciono ningún archivo"),!1;if(n.files[0].size>2097152)return GISSAT.ToastWarning("Verifique que el archivo no supere los 2MB"),$("#inputFileServer").filestyle("clear"),$("#txtLink").val(""),!1;Eventos.SaveFileServer()});$("#btnConfigurarCorreo").on("click",function(){DBR.validarCampo("#cboEventosActivos")?(Funciones.LimpiarControles(),$("#txtCorreoOrigen").val(CorreoOrigen),$("#txtNombreOrigen").val(NombreCorreoOrigen),$("#modalAgregarCorreo").modal("show"),Eventos.GetEventoCorreo()):DBR.ToastWarning("Seleccione un evento")});$("#btnEnviarCorreo").on("click",function(){DBR.validarCampo("#cboEventosActivos")?Eventos.EnviarCorreo():DBR.ToastWarning("Seleccione un evento")});var n=CKEDITOR.replace("txtMensajeCompleto",{filebrowserBrowseUrl:urlFileServerBrowse,filebrowserUploadUrl:urlSaveFileServerCkEditor});n.on("change",function(n){contenidoHtml=n.editor.getData()});$("#btnGuardarCorreo").on("click",function(){var n=!0;DBR.validarCampo("#txtAsuntoMensaje")||(n=!1);DBR.validarCampo("#txtCorreoOrigen")||(n=!1);DBR.validarCampo("#txtNombreOrigen")||(n=!1);$.trim(contenidoHtml).length==0&&(contenidoHtml="<p><\/p>");n&&Eventos.SaveEventoCorreo()});$("#btnGuardarEventoUsuario").on("click",function(){var n=!0;DBR.validarCampo("#txtFechaInicio")||(n=!1);DBR.validarCampo("#txtFechaFin")||(n=!1);n&&Eventos.SaveEventoUsuario()})});