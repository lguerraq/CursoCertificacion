var config={iniGrids:{GrillaUsuarios:function(){$("#gridUsuarios").DataTable({searching:!0,ordering:!1,processing:!0,serverSide:!0,destroy:!0,responsive:!0,language:{url:"//cdn.datatables.net/plug-ins/1.10.15/i18n/Spanish.json"},ajax:{url:urlListUsuarioPaged,type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:function(n){return JSON.stringify({page:n})}},columns:[{data:"Login"},{data:"Password"},{data:"Nombres"},{data:"ApellidoPaterno"},{data:"ApellidoMaterno"},{data:"UsuarioTipo"},{data:function(n){var t='<a data-toggle="tooltip1" data-placement="bottom" title="Editar" onclick="Eventos.GetUsuario('+n.IdUsuario+')" class="btn btn-primary btn-xs"><span class="glyphicon glyphicon-pencil" aria-hidden="true"><\/span><\/a>',i='<a data-toggle="tooltip1" data-placement="bottom" title="Eliminar" onclick="Eventos.DeleteUsuario('+n.IdUsuario+')" class="btn btn-primary btn-xs"><span class="glyphicon glyphicon-trash" aria-hidden="true"><\/span><\/a>',r='<a data-toggle="tooltip1" data-placement="bottom" title="Credenciales" onclick="Eventos.EnviarCredencialesUsuario(\''+n.Login+'\')" class="btn btn-primary btn-xs"><i class="fa fa-key" aria-hidden="true"><\/i><\/a>';return t+" "+i+" "+r},sClass:"text-center"}],drawCallback:function(){$('[data-toggle="tooltip1"]').tooltip()}})}}},Eventos={ListUsuarioTipo:function(){$.ajax({url:urlListUsuarioTipo,type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){DBR.LlenarCombo(n,"#cboTipoUsuario",!1,!1,"Seleccione")},error:function(n,t){console.log(t)}})},SaveUsuario:function(){var n={};n.IdUsuario=$("#txtIdUsuario").val();n.Login=$("#txtLogin").val();n.Password=$("#txtPassword").val();n.NumeroDocumento=$("#txtNumeroDocumento").val();n.Nombres=$("#txtNombres").val().toUpperCase();n.ApellidoPaterno=$("#txtApellidoPaterno").val().toUpperCase();n.ApellidoMaterno=$("#txtApellidoMaterno").val().toUpperCase();n.Correo=$("#txtCorreo").val().toUpperCase();n.IdUsuarioTipo=$("#cboTipoUsuario").val();DBR.blockUIStar();$.ajax({url:urlSaveUsuario,type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify({request:n}),success:function(n){DBR.blockUIStop();n.IsSuccess?($("#gridUsuarios").DataTable().ajax.reload(),$("#modalUsuario").modal("hide"),DBR.ToastSuccess(n.Message)):DBR.ToastError(n.Message)},error:function(n,t){DBR.blockUIStop();console.log(t)}})},GetUsuario:function(n){$("#lblTitleAgregarUsuario").html("Editar");Funciones.LimpiarCamposUsuario();var t={};t.IdUsuario=n;DBR.blockUIStar();$.ajax({url:urlGetUsuario,type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify({request:t}),success:function(n){DBR.blockUIStop();$("#txtIdUsuario").val(n.IdUsuario);$("#txtLogin").val(n.Login);$("#txtPassword").val(n.Password);$("#txtNumeroDocumento").val(n.NumeroDocumento);$("#txtNombres").val(n.Nombres);$("#txtApellidoPaterno").val(n.ApellidoPaterno);$("#txtApellidoMaterno").val(n.ApellidoMaterno);$("#txtCorreo").val(n.Correo);$("#cboTipoUsuario").val(n.IdUsuarioTipo);$("#modalUsuario").modal("show")},error:function(n,t){DBR.blockUIStop();console.log(t)}})},DeleteUsuario:function(n){var t={};t.IdUsuario=n;BootstrapDialog.show({title:"Confirmación",closeByBackdrop:!1,message:"¿Esta seguro de eliminar el registro?",size:BootstrapDialog.SIZE_SMALL,buttons:[{label:"Si",cssClass:"btn-primary btn-sm",action:function(n){DBR.blockUIStar();$.ajax({url:urlDeleteUsuario,type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify({request:t}),success:function(t){DBR.blockUIStop();n.close();t.IsSuccess?($("#gridUsuarios").DataTable().ajax.reload(),DBR.ToastSuccess(t.Message)):DBR.ToastError(t.Message)},error:function(n,t){DBR.blockUIStop();console.log(t)}})}},{label:"No",cssClass:"btn-default btn-sm",action:function(n){n.close()}}]})},EnviarCredencialesUsuario:function(n){var t={};t.Login=n;BootstrapDialog.show({title:"Confirmación",closeByBackdrop:!1,message:"¿Esta seguro de enviar los credenciales?",size:BootstrapDialog.SIZE_SMALL,buttons:[{label:"Si",cssClass:"btn-primary btn-sm",action:function(n){DBR.blockUIStar();$.ajax({url:urlRenviarCredenciales,type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify({request:t}),success:function(t){DBR.blockUIStop();n.close();t.IsSuccess?DBR.ToastSuccess(t.Message):DBR.ToastError(t.Message)},error:function(n,t){DBR.blockUIStop();console.log(t)}})}},{label:"No",cssClass:"btn-default btn-sm",action:function(n){n.close()}}]})},GetPersona:function(){var n={};n.NumeroDocumento=$("#txtNumeroDocumento").val();DBR.blockUIStar();$.ajax({url:urlGetPersonaXdni,type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify({request:n}),success:function(n){DBR.blockUIStop();n.length>0?($("#txtNombres").val(n[0].Nombres),$("#txtApellidoPaterno").val(n[0].ApellidoPaterno),$("#txtApellidoMaterno").val(n[0].ApellidoMaterno),$("#txtLogin").val(n[0].NumeroDocumento),$("#txtCorreo").val(n[0].Correo),DBR.ToastSuccess("Persona encontrada")):($("#txtLogin").val(""),$("#txtNombres").val(""),$("#txtApellidoPaterno").val(""),$("#txtApellidoMaterno").val(""),$("#txtCorreo").val(""),DBR.ToastWarning("No se encontro persona"))},error:function(n,t){console.log(t)}})}},Funciones={LimpiarCamposUsuario:function(){DBR.limpiarCampo("#txtLogin");DBR.limpiarCampo("#txtPassword");DBR.limpiarCampo("#txtNumeroDocumento");DBR.limpiarCampo("#txtNombres");DBR.limpiarCampo("#txtApellidoPaterno");DBR.limpiarCampo("#txtApellidoMaterno");DBR.limpiarCampo("#txtCorreo");DBR.limpiarCampo("#cboTipoUsuario")}};$(document).ready(function(){config.iniGrids.GrillaUsuarios();Eventos.ListUsuarioTipo();$("#btnAgregarUsuario").on("click",function(){$("#lblTitleAgregarUsuario").html("Agregar");$("#txtIdUsuario").val(0);Funciones.LimpiarCamposUsuario();$("#modalUsuario").modal("show")});$("#btnGuardarUsuario").on("click",function(){var n=!0;DBR.validarCampo("#txtLogin")||(n=!1);DBR.validarCampo("#txtPassword")||(n=!1);DBR.validarCampo("#txtNumeroDocumento")||(n=!1);DBR.validarCampo("#txtNombres")||(n=!1);DBR.validarCampo("#txtApellidoPaterno")||(n=!1);DBR.validarCampo("#txtApellidoMaterno")||(n=!1);DBR.validarCampo("#txtCorreo")||(n=!1);DBR.validarCampo("#cboTipoUsuario")||(n=!1);n&&Eventos.SaveUsuario()});$("#btnBuscarPorDni").on("click",function(){Eventos.GetPersona()})});